<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>ChatSmo - Dani_MK</title>
<style>
/* CSS simplifié pour le chat */
body { font-family:'Segoe UI', sans-serif; background:#000; color:white; margin:0; }
.page { display:flex; justify-content:center; align-items:center; min-height:100vh; padding-top:50px; }
.chat-card { width:90%; max-width:800px; height:600px; background:#111; border-radius:20px; display:flex; flex-direction:column; }
.chat-window { flex:1; padding:15px; overflow-y:auto; display:flex; flex-direction:column; gap:10px; }
.chat-input { display:flex; padding:10px; border-top:1px solid #333; }
.chat-input input { flex:1; padding:10px; border-radius:10px; border:none; }
.chat-input button { margin-left:10px; padding:0 20px; border-radius:10px; border:none; background:#4c00ff; color:white; cursor:pointer; }
.message { padding:8px 12px; border-radius:10px; max-width:80%; }
.user { background:#333; align-self:flex-end; }
.ia { background:#4c00ff; align-self:flex-start; }
</style>
</head>
<body>

<div class="page">
    <div class="chat-card">
        <div class="chat-window" id="chat-window">
            Tapez un message pour commencer...
        </div>
        <div class="chat-input">
            <input type="text" id="user-input" placeholder="Écrire un message...">
            <button onclick="sendMessage()">Envoyer</button>
        </div>
    </div>
</div>

<script>
function addMessage(text, type){
    const chatWindow = document.getElementById("chat-window");
    const div = document.createElement("div");
    div.className = "message " + type;
    div.innerHTML = text.replace(/\n/g,"<br>");
    chatWindow.appendChild(div);
    chatWindow.scrollTop = chatWindow.scrollHeight;
}

async function sendMessage(){
    const input = document.getElementById("user-input");
    const message = input.value.trim();
    if(!message) return;
    addMessage(message, "user");
    input.value = "";

    try {
        const res = await fetch("https://flask-danielabernard.replit.app/chat", {
        method:"POST",
         headers:{"Content-Type":"application/json"},
         body: JSON.stringify({message})
        });

        const data = await res.json();
        addMessage(data.response, "ia");
    } catch(err){
        console.error(err);
        addMessage("Erreur: Impossible de contacter le serveur.", "ia");
    }
}

document.getElementById("user-input").addEventListener("keypress", function(e){
    if(e.key === "Enter") sendMessage();
});
</script>

</body>
</html>
